<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aper√ßu en Direct - E-Contact Pro</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
        }

        .preview-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            height: 100vh;
            gap: 0;
        }

        .editor-panel {
            background: white;
            overflow-y: auto;
            border-right: 1px solid #ddd;
            padding: 20px;
        }

        .preview-panel {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            overflow-y: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .preview-device {
            width: 100%;
            max-width: 400px;
            height: 600px;
            background: white;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            border: 8px solid #333;
            position: relative;
        }

        .preview-device::before {
            content: '';
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 24px;
            background: #333;
            border-radius: 0 0 24px 24px;
            z-index: 10;
        }

        .preview-content {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            padding: 20px;
        }

        .editor-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 20px;
            color: #667eea;
        }

        .editor-section {
            margin-bottom: 25px;
        }

        .editor-section-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e8eef5;
        }

        .color-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 12px;
        }

        input[type="color"] {
            width: 50px;
            height: 50px;
            border: 2px solid #e8eef5;
            border-radius: 8px;
            cursor: pointer;
            padding: 4px;
        }

        input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #e8eef5;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }

        .position-display {
            font-size: 0.85em;
            color: #999;
            margin-top: 5px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            flex: 1;
            padding: 12px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #ecf0f1;
            color: #2c3e50;
        }

        .btn-secondary:hover {
            background: #d5dbdb;
        }

        @media (max-width: 1024px) {
            .preview-container {
                grid-template-columns: 1fr;
            }

            .editor-panel {
                border-right: none;
                border-bottom: 1px solid #ddd;
            }

            .preview-device {
                max-width: 300px;
                height: 500px;
            }
        }
    </style>
</head>
<body>
    <div class="preview-container">
        <!-- PANEL √âDITEUR -->
        <div class="editor-panel">
            <h1 class="editor-title">‚úèÔ∏è √âditer en Direct</h1>

            <form id="liveForm">
                <!-- COULEURS -->
                <div class="editor-section">
                    <div class="editor-section-title">üé® Couleurs</div>

                    <div class="color-input-group">
                        <label>Principale</label>
                        <input type="color" id="couleur_principale" value="{{ profil.couleur_principale }}" onchange="updatePreview()">
                    </div>

                    <div class="color-input-group">
                        <label>Fond</label>
                        <input type="color" id="couleur_fond" value="{{ profil.couleur_fond }}" onchange="updatePreview()">
                    </div>

                    <div class="color-input-group">
                        <label>Titres</label>
                        <input type="color" id="couleur_texte_h1" value="{{ profil.couleur_texte_h1 }}" onchange="updatePreview()">
                    </div>

                    <div class="color-input-group">
                        <label>Texte</label>
                        <input type="color" id="couleur_texte_bio" value="{{ profil.couleur_texte_bio }}" onchange="updatePreview()">
                    </div>
                </div>

                <!-- POSITION PHOTO -->
                <div class="editor-section">
                    <div class="editor-section-title">üì∏ Position Photo</div>

                    <div style="margin-bottom: 15px;">
                        <label>Horizontal: <span id="posX">{{ profil.photo_position_x }}</span>%</label>
                        <input type="range" id="photo_position_x" min="0" max="100" value="{{ profil.photo_position_x }}" onchange="updatePreview()">
                    </div>

                    <div>
                        <label>Vertical: <span id="posY">{{ profil.photo_position_y }}</span>%</label>
                        <input type="range" id="photo_position_y" min="0" max="100" value="{{ profil.photo_position_y }}" onchange="updatePreview()">
                    </div>
                </div>

                <!-- BOUTONS -->
                <div class="button-group">
                    <a href="{{ url_for('edit_profil', slug_profil=profil.slug) }}" class="btn-secondary" style="text-decoration: none; display: flex; align-items: center; justify-content: center;">‚Üê Retour</a>
                    <a href="{{ url_for('profil_public', slug_profil=profil.slug) }}" class="btn-secondary" target="_blank" style="text-decoration: none; display: flex; align-items: center; justify-content: center;">üëÅÔ∏è Voir en Direct</a>
                </div>
            </form>
        </div>

        <!-- PANEL APER√áU -->
        <div class="preview-panel">
            <div class="preview-device">
                <div class="preview-content" id="previewContent" style="background: {{ profil.couleur_fond }};">
                    {% include 'profil_templates/' + profil.template + '.html' %}
                </div>
            </div>
        </div>
    </div>

    <script>
        function updatePreview() {
            const couleur_principale = document.getElementById('couleur_principale').value;
            const couleur_fond = document.getElementById('couleur_fond').value;
            const couleur_texte_h1 = document.getElementById('couleur_texte_h1').value;
            const couleur_texte_bio = document.getElementById('couleur_texte_bio').value;
            const photo_position_x = document.getElementById('photo_position_x').value;
            const photo_position_y = document.getElementById('photo_position_y').value;

            // Mettre √† jour l'affichage des positions
            document.getElementById('posX').textContent = photo_position_x;
            document.getElementById('posY').textContent = photo_position_y;

            // Mettre √† jour le CSS du pr√©view
            const previewContent = document.getElementById('previewContent');
            previewContent.style.cssText = `
                background: ${couleur_fond};
                --color-primary: ${couleur_principale};
                --color-text-h1: ${couleur_texte_h1};
                --color-text-bio: ${couleur_texte_bio};
                --photo-position-x: ${photo_position_x}%;
                --photo-position-y: ${photo_position_y}%;
            `;

            // Mettre √† jour les √©l√©ments
            const elements = previewContent.querySelectorAll('[style*="couleur"]');
            elements.forEach(el => {
                el.style.color = couleur_texte_bio;
            });
        }

        // Initialiser la pr√©view
        updatePreview();
    </script>
</body>
</html>